<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Data Streaming - Niagara Data Platform</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Data Streaming";
    var mkdocs_page_input_path = "stream.md";
    var mkdocs_page_url = "/stream/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Niagara Data Platform</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../install/">Installation</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Data Streaming</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#streaming-frameworks">Streaming Frameworks</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#kafka-streams">Kafka Streams</a></li>
        
            <li><a class="toctree-l3" href="#akka-streams">Akka Streams</a></li>
        
            <li><a class="toctree-l3" href="#spark-streaming">Spark Streaming</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../escqrs/">Event Sourcing & CQRS</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ml/">Machine Learning</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../about/">About</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Niagara Data Platform</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Data Streaming</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="streaming-frameworks">Streaming Frameworks</h1>
<h2 id="kafka-streams">Kafka Streams</h2>
<p>In many use cases, we have to support an event-by-event low latency model rather than one that focuses on microbatches,
and deliver upstream changes to the materialized state store to serve microservice.</p>
<p>A Spark core app ingests Json files and converts Json to Avro messages in Kafka topics, e.g. review, business, user.</p>
<p>A Kafka streams application consumes review messages as KStream from review topic.
In the meanwhile, it consumes Business and User data as GlobalKTable.</p>
<p>KStream works like Fact table, containing large volume immutable transactional records.
While KTable works like Dimension table, contains small volume domain data snapshot.
The pipeline enriches Review Stream by joining with Business and User KTables in real-time to a new Kafka topic.
Then, apply filtering, aggregations and keep the results in local state store to provide Micro-service for Interactive Queries.</p>
<p>For example, KeyValue query on stars summed by city</p>
<pre><code>GET /stars/{city}
</code></pre>

<p>Range Query on stars sumed by business in a time window</p>
<pre><code>GET /stars/{business}/{from}/{to}
</code></pre>

<h2 id="akka-streams">Akka Streams</h2>
<p>The Akka Streams application ingests XML format posts by the file connector in Alpakka.
Akka streams producer app forms a real-time data pipeline to parse, enrich and transform XML files to Avro messages in a Kafka topic.</p>
<p>An Akka stream consumer app consumes avro messages from Kafka, and then persists data into Cassandra database.
The data flow DSL is shown below:</p>
<pre><code>xmlSource ~&gt; parsing ~&gt; broadcast ~&gt; enrich1 ~&gt; merge ~&gt; fillTitle ~&gt; kafkaSink
                        broadcast ~&gt; enrich2 ~&gt; merge
</code></pre>

<p>The service layer provides RESTful APIs built by Akka-Http for users to easily interact with data for ad-hoc analytics.
Under the hood, the service calls Cassandra APIs to implement CRUD operations.</p>
<h2 id="spark-streaming">Spark Streaming</h2>
<p>A Spark core app ingests Json files and converts Json to Avro messages in Kafka topics, e.g. review, business, user.
A Spark streaming consumer consumes data from Kafka, and then do the transformation and aggregation.
Select features and persist them into Cassandra.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../escqrs/" class="btn btn-neutral float-right" title="Event Sourcing & CQRS">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../install/" class="btn btn-neutral" title="Installation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Crafted by <a href="http://alvincjin.github.io">Alvin Jin</a></p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../install/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../escqrs/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../js/theme.js"></script>

</body>
</html>
